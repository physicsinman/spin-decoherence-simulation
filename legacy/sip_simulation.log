/Users/physicsinman/Library/Mobile Documents/com~apple~CloudDocs/Documents/Physics/Physics_3rd_Year/5th Semester/Dissertation/simulation/improved_t2_extraction.py:314: UserWarning: T2 value (31250000.00 Î¼s) capped at 1000000.00 Î¼s
  warnings.warn(f"T2 value ({T2*1e6:.2f} Î¼s) capped at {T2_max_reasonable*1e6:.2f} Î¼s")
/Users/physicsinman/Library/Mobile Documents/com~apple~CloudDocs/Documents/Physics/Physics_3rd_Year/5th Semester/Dissertation/simulation/improved_t2_extraction.py:314: UserWarning: T2 value (23296964.18 Î¼s) capped at 1000000.00 Î¼s
  warnings.warn(f"T2 value ({T2*1e6:.2f} Î¼s) capped at {T2_max_reasonable*1e6:.2f} Î¼s")
/Users/physicsinman/Library/Mobile Documents/com~apple~CloudDocs/Documents/Physics/Physics_3rd_Year/5th Semester/Dissertation/simulation/improved_t2_extraction.py:314: UserWarning: T2 value (17367953.28 Î¼s) capped at 1000000.00 Î¼s
  warnings.warn(f"T2 value ({T2*1e6:.2f} Î¼s) capped at {T2_max_reasonable*1e6:.2f} Î¼s")
/Users/physicsinman/Library/Mobile Documents/com~apple~CloudDocs/Documents/Physics/Physics_3rd_Year/5th Semester/Dissertation/simulation/improved_t2_extraction.py:314: UserWarning: T2 value (12947858.73 Î¼s) capped at 1000000.00 Î¼s
  warnings.warn(f"T2 value ({T2*1e6:.2f} Î¼s) capped at {T2_max_reasonable*1e6:.2f} Î¼s")
/Users/physicsinman/Library/Mobile Documents/com~apple~CloudDocs/Documents/Physics/Physics_3rd_Year/5th Semester/Dissertation/simulation/improved_t2_extraction.py:314: UserWarning: T2 value (9652665.63 Î¼s) capped at 1000000.00 Î¼s
  warnings.warn(f"T2 value ({T2*1e6:.2f} Î¼s) capped at {T2_max_reasonable*1e6:.2f} Î¼s")
/Users/physicsinman/Library/Mobile Documents/com~apple~CloudDocs/Documents/Physics/Physics_3rd_Year/5th Semester/Dissertation/simulation/improved_t2_extraction.py:314: UserWarning: T2 value (7196089.77 Î¼s) capped at 1000000.00 Î¼s
  warnings.warn(f"T2 value ({T2*1e6:.2f} Î¼s) capped at {T2_max_reasonable*1e6:.2f} Î¼s")
/Users/physicsinman/Library/Mobile Documents/com~apple~CloudDocs/Documents/Physics/Physics_3rd_Year/5th Semester/Dissertation/simulation/improved_t2_extraction.py:314: UserWarning: T2 value (5364705.46 Î¼s) capped at 1000000.00 Î¼s
  warnings.warn(f"T2 value ({T2*1e6:.2f} Î¼s) capped at {T2_max_reasonable*1e6:.2f} Î¼s")
/Users/physicsinman/Library/Mobile Documents/com~apple~CloudDocs/Documents/Physics/Physics_3rd_Year/5th Semester/Dissertation/simulation/improved_t2_extraction.py:314: UserWarning: T2 value (3999403.23 Î¼s) capped at 1000000.00 Î¼s
  warnings.warn(f"T2 value ({T2*1e6:.2f} Î¼s) capped at {T2_max_reasonable*1e6:.2f} Î¼s")
/Users/physicsinman/Library/Mobile Documents/com~apple~CloudDocs/Documents/Physics/Physics_3rd_Year/5th Semester/Dissertation/simulation/improved_t2_extraction.py:314: UserWarning: T2 value (2981566.52 Î¼s) capped at 1000000.00 Î¼s
  warnings.warn(f"T2 value ({T2*1e6:.2f} Î¼s) capped at {T2_max_reasonable*1e6:.2f} Î¼s")
================================================================================
Si_P ì „ì²´ ì‹œë®¬ë ˆì´ì…˜ ì‹¤í–‰
================================================================================

ì„¤ì •:
  â€¢ Material: Si_P
  â€¢ Noise models: OU, Double_OU
  â€¢ Sequences: FID, Hahn
  â€¢ Parameter validation: âœ“
  â€¢ Memory-efficient: âœ“
  â€¢ Improved T2 extraction: âœ“

ì˜ˆìƒ ì‹œê°„:
  â€¢ Si_P OU: ~14ì‹œê°„
  â€¢ Si_P Double_OU: ~1.8ì‹œê°„
  â€¢ ì´í•©: ~16ì‹œê°„

ì‹œì‘í•©ë‹ˆë‹¤...

======================================================================
IMPROVED MATERIAL COMPARISON SIMULATION
======================================================================

Settings:
  Parameter validation: âœ“
  Adaptive simulation: âœ“
  Improved T2 extraction: âœ“
======================================================================

============================================================
Running (Improved): Si_P | OU | FID
============================================================

[1/5] Parameter Validation...

============================================================
Parameter Comparison for Si_P
============================================================

B_rms Comparison:
  Literature (required): 3.214 nT
  Current simulation:   3.210 nT
  Ratio: 1.0Ã—

T_max Comparison:
  Required (â‰¥5Ã—T2*): 12500.0 Âµs
  Current simulation:  5000.0 Âµs
  Ratio: 0.40Ã—

ğŸ’¡ RECOMMENDATIONS:
   - T_max is 2.5Ã— too short. Update to â‰¥ 12500.0 Âµs
============================================================

âš ï¸  Using validated B_rms, but keeping T_max from profiles.yaml

============================================================
=== Si_P Parameter Validation ===
============================================================
Target T2*: 2500.000 Âµs = 2.500 ms
Noise amplitude Ïƒ_z: 3.214 nT = 0.003214 ÂµT
Total simulation time: 25000.0 Âµs = 25.000 ms
Time step dt: 1.000 ns
Number of time steps: 25,000,000
Ï„_c range: 0.100 - 500.0 Âµs

Estimated memory:
  Per ensemble: 0.20 GB
  Total (100 ensembles): 20.00 GB

âš ï¸  WARNINGS:
   - Memory requirement (20.00 GB) exceeds typical limits!

ğŸ’¡ RECOMMENDATIONS:
   - Consider: 1) Shorter total_time, 2) Larger dt, 3) Fewer ensembles

âœ— Some validation checks failed
============================================================

[2/5] Using Memory-Efficient Simulation (Adaptive disabled for full decay observation)...
[3/5] Using Improved T2 Extraction...

  [1/30] tau_c = 0.100 Âµs
      Regime: motional_narrowing
      T2_expected = 31250000.00 Âµs
      T_max_adaptive = 26214.40 Âµs (extended from 5000.00 Âµs)
      [MEMORY LIMIT] T_max capped at 26214.40 Âµs due to memory constraints
      [MEMORY] Estimated memory: 58.6 GB
      [MEMORY] Using online mode (bootstrap will use analytical estimate)

  [2/30] tau_c = 0.134 Âµs
      Regime: motional_narrowing
      T2_expected = 23296964.18 Âµs
      T_max_adaptive = 26214.40 Âµs (extended from 5000.00 Âµs)
      [MEMORY LIMIT] T_max capped at 26214.40 Âµs due to memory constraints
      [MEMORY] Estimated memory: 58.6 GB
      [MEMORY] Using online mode (bootstrap will use analytical estimate)

  [3/30] tau_c = 0.180 Âµs
      Regime: motional_narrowing
      T2_expected = 17367953.28 Âµs
      T_max_adaptive = 26214.40 Âµs (extended from 5000.00 Âµs)
      [MEMORY LIMIT] T_max capped at 26214.40 Âµs due to memory constraints
      [MEMORY] Estimated memory: 58.6 GB
      [MEMORY] Using online mode (bootstrap will use analytical estimate)

  [4/30] tau_c = 0.241 Âµs
      Regime: motional_narrowing
      T2_expected = 12947858.73 Âµs
      T_max_adaptive = 26214.40 Âµs (extended from 5000.00 Âµs)
      [MEMORY LIMIT] T_max capped at 26214.40 Âµs due to memory constraints
      [MEMORY] Estimated memory: 58.6 GB
      [MEMORY] Using online mode (bootstrap will use analytical estimate)

  [5/30] tau_c = 0.324 Âµs
      Regime: motional_narrowing
      T2_expected = 9652665.63 Âµs
      T_max_adaptive = 26214.40 Âµs (extended from 5000.00 Âµs)
      [MEMORY LIMIT] T_max capped at 26214.40 Âµs due to memory constraints
      [MEMORY] Estimated memory: 58.6 GB
      [MEMORY] Using online mode (bootstrap will use analytical estimate)

  [6/30] tau_c = 0.434 Âµs
      Regime: motional_narrowing
      T2_expected = 7196089.77 Âµs
      T_max_adaptive = 26214.40 Âµs (extended from 5000.00 Âµs)
      [MEMORY LIMIT] T_max capped at 26214.40 Âµs due to memory constraints
      [MEMORY] Estimated memory: 58.6 GB
      [MEMORY] Using online mode (bootstrap will use analytical estimate)

  [7/30] tau_c = 0.583 Âµs
      Regime: motional_narrowing
      T2_expected = 5364705.46 Âµs
      T_max_adaptive = 26214.40 Âµs (extended from 5000.00 Âµs)
      [MEMORY LIMIT] T_max capped at 26214.40 Âµs due to memory constraints
      [MEMORY] Estimated memory: 58.6 GB
      [MEMORY] Using online mode (bootstrap will use analytical estimate)

  [8/30] tau_c = 0.781 Âµs
      Regime: motional_narrowing
      T2_expected = 3999403.23 Âµs
      T_max_adaptive = 26214.40 Âµs (extended from 5000.00 Âµs)
      [MEMORY LIMIT] T_max capped at 26214.40 Âµs due to memory constraints
      [MEMORY] Estimated memory: 58.6 GB
      [MEMORY] Using online mode (bootstrap will use analytical estimate)

  [9/30] tau_c = 1.048 Âµs
      Regime: motional_narrowing
      T2_expected = 2981566.52 Âµs
      T_max_adaptive = 26214.40 Âµs (extended from 5000.00 Âµs)
      [MEMORY LIMIT] T_max capped at 26214.40 Âµs due to memory constraints
      [MEMORY] Estimated memory: 58.6 GB
      [MEMORY] Using online mode (bootstrap will use analytical estimate)

  [10/30] tau_c = 1.406 Âµs
      Regime: motional_narrowing
      T2_expected = 2222766.35 Âµs
      T_max_adaptive = 26214.40 Âµs (extended from 5000.00 Âµs)
      [MEMORY LIMIT] T_max capped at 26214.40 Âµs due to memory constraints
      [MEMORY] Estimated memory: 58.6 GB
      [MEMORY] Using online mode (bootstrap will use analytical estimate)
      Using analytical CI (online mode: no ensemble data for bootstrap)

  [11/30] tau_c = 1.886 Âµs
      Regime: motional_narrowing
      T2_expected = 1657078.66 Âµs
      T_max_adaptive = 26214.40 Âµs (extended from 5000.00 Âµs)
      [MEMORY LIMIT] T_max capped at 26214.40 Âµs due to memory constraints
      [MEMORY] Estimated memory: 58.6 GB
      [MEMORY] Using online mode (bootstrap will use analytical estimate)
      Using analytical CI (online mode: no ensemble data for bootstrap)

  [12/30] tau_c = 2.530 Âµs
      Regime: motional_narrowing
      T2_expected = 1235356.87 Âµs
      T_max_adaptive = 26214.40 Âµs (extended from 5000.00 Âµs)
      [MEMORY LIMIT] T_max capped at 26214.40 Âµs due to memory constraints
      [MEMORY] Estimated memory: 58.6 GB
      [MEMORY] Using online mode (bootstrap will use analytical estimate)
      Using analytical CI (online mode: no ensemble data for bootstrap)

  [13/30] tau_c = 3.393 Âµs
      Regime: motional_narrowing
      T2_expected = 920962.07 Âµs
      T_max_adaptive = 26214.40 Âµs (extended from 5000.00 Âµs)
      [MEMORY LIMIT] T_max capped at 26214.40 Âµs due to memory constraints
      [MEMORY] Estimated memory: 58.6 GB
      [MEMORY] Using online mode (bootstrap will use analytical estimate)
      Using analytical CI (online mode: no ensemble data for bootstrap)

  [14/30] tau_c = 4.552 Âµs
      Regime: motional_narrowing
      T2_expected = 686579.85 Âµs
      T_max_adaptive = 26214.40 Âµs (extended from 5000.00 Âµs)
      [MEMORY LIMIT] T_max capped at 26214.40 Âµs due to memory constraints
      [MEMORY] Estimated memory: 58.6 GB
      [MEMORY] Using online mode (bootstrap will use analytical estimate)
      Using analytical CI (online mode: no ensemble data for bootstrap)

  [15/30] tau_c = 6.105 Âµs
      Regime: motional_narrowing
      T2_expected = 511847.24 Âµs
      T_max_adaptive = 26214.40 Âµs (extended from 5000.00 Âµs)
      [MEMORY LIMIT] T_max capped at 26214.40 Âµs due to memory constraints
      [MEMORY] Estimated memory: 58.6 GB
      [MEMORY] Using online mode (bootstrap will use analytical estimate)
      Using analytical CI (online mode: no ensemble data for bootstrap)

  [16/30] tau_c = 8.190 Âµs
